(function(){var e,t;$(function(){return $(document).on("click","a.button.has_many_remove",function(e){var a,n;return e.preventDefault(),a=$(this).closest(".has_many_container"),n=$(this).closest("fieldset"),t(a),a.trigger("has_many_remove:before",[n,a]),n.remove(),a.trigger("has_many_remove:after",[n,a])}),$(document).on("click","a.button.has_many_add",function(e){var a,n,r,s,i,o;return e.preventDefault(),i=$(this).closest(".has_many_container"),i.trigger(a=$.Event("has_many_add:before"),[i]),a.isDefaultPrevented()?void 0:(s=i.data("has_many_index")||i.children("fieldset").length-1,i.data({has_many_index:++s}),o=new RegExp($(this).data("placeholder"),"g"),r=$(this).data("html").replace(o,s),n=$(r).insertBefore(this),t(i),i.trigger("has_many_add:after",[n,i]))}),$(document).on("change",'.has_many_container[data-sortable] :input[name$="[_destroy]"]',function(){return t($(this).closest(".has_many"))}),e(),$(document).on("has_many_add:after",".has_many_container",e)}),e=function(){var e;return e=$(".has_many_container[data-sortable]:not(.ui-sortable)"),e.sortable({items:"> fieldset",handle:"> ol > .handle",stop:t}),e.each(t)},t=function(e){var t,a;return e=e instanceof jQuery?e:$(this),t=e.data("sortable"),a=parseInt(e.data("sortable-start")||0,10),e.children("fieldset").each(function(){var e,n;return e=$(this).find("> ol > .input > :input[name$='[_destroy]']"),n=$(this).find("> ol > .input > :input[name$='["+t+"]']"),n.length?n.val(e.is(":checked")?"":a++):void 0})}}).call(this);